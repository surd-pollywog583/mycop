id: GO-SEC-039
name: sql-string-concat
severity: critical
language: go
cwe: CWE-89
owasp: "A03:2021"
description: "Detect SQL queries built with string concatenation, vulnerable to SQL injection."
pattern:
  type: regex
  regex:
    - "\"(?:SELECT|INSERT|UPDATE|DELETE)\\s.*\"\\s*\\+"
    - "(?:SELECT|INSERT|UPDATE|DELETE).*\\+\\s*\\w+"
message: "SQL query built with string concatenation. This is vulnerable to SQL injection."
fix_hint: "Use parameterized queries or prepared statements. Never concatenate user input into SQL."
references:
  - "https://cwe.mitre.org/data/definitions/89.html"
