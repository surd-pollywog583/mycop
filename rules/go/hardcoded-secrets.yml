id: GO-SEC-003
name: hardcoded-secrets
severity: high
language: go
cwe: CWE-798
owasp: "A07:2021"
description: "Detect hardcoded API keys, tokens, passwords"
pattern:
  type: regex
  regex:
    - "(?i)(?:api[_-]?key|secret|token|password|passwd|credential)\\s*[:=]\\s*\"[A-Za-z0-9+/=_-]{16,}\""
    - "(?i)(?:AKIA|sk-|ghp_|gho_|glpat-)[A-Za-z0-9]{10,}"
message: "Hardcoded secret detected. Credentials should not be stored in source code."
fix_hint: "Use environment variables or a secrets manager instead of hardcoding credentials."
references:
  - "https://cwe.mitre.org/data/definitions/798.html"
