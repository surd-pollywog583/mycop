id: GO-SEC-001
name: sql-injection
severity: critical
language: go
cwe: CWE-89
owasp: "A03:2021"
description: "Detect SQL injection via string formatting in database queries"
pattern:
  type: regex
  regex:
    - "fmt\\.Sprintf\\s*\\(\\s*\"[^\"]*(?:SELECT|INSERT|UPDATE|DELETE|WHERE)"
    - "db\\.(?:Query|Exec|QueryRow)\\s*\\(\\s*\"[^\"]*\\+"
    - "db\\.(?:Query|Exec|QueryRow)\\s*\\(\\s*fmt\\.Sprintf"
message: "Possible SQL injection. User input may be interpolated into SQL query."
fix_hint: "Use parameterized queries with ? or $1 placeholders instead of string concatenation."
references:
  - "https://cwe.mitre.org/data/definitions/89.html"
