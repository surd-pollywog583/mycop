id: JAVA-SEC-045
name: weak-password-hash
severity: medium
language: java
cwe: CWE-916
owasp: "A02:2021"
description: "Detects weak password hashing algorithms without salt or iteration."
pattern:
  type: regex
  regex:
    - "MessageDigest.*(?:MD5|SHA-1).*password"
    - "(?i)hash\\s*\\(.*password"
    - "DigestUtils\\.(?:md5|sha1).*(?i)password"
message: "Weak password hashing algorithm. Plain hash without salt or iteration."
fix_hint: "Use bcrypt, scrypt, or PBKDF2 for password hashing."
references:
  - "https://cwe.mitre.org/data/definitions/916.html"
